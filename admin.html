<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="robots" content="noindex, nofollow" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DropCharge Admin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./assets/styles.css" />
  <link rel="stylesheet" href="./assets/admin.css" />
</head>
<body class="admin">
  <div class="admin-shell">
    <aside class="admin-sidebar">
      <div class="sidebar-head">
        <h1>DropCharge</h1>
        <p class="micro">Admin Dashboard</p>
        <button class="btn mini ghost" id="admin-logout">Logout</button>
      </div>
      <nav class="admin-nav" role="tablist">
        <button class="nav-link active" data-tab="dashboard">Dashboard</button>
        <button class="nav-link" data-tab="newsletter">Newsletter</button>
        <button class="nav-link" data-tab="campaigns">Campaigns</button>
        <button class="nav-link" data-tab="tracking">Tracking Links</button>
        <button class="nav-link" data-tab="analytics">Analytics</button>
      </nav>
      <div class="sidebar-footer">
        <a class="btn ghost" href="/" target="_blank">← Back to Site</a>
      </div>
    </aside>

    <main class="admin-main">
      <!-- Dashboard Overview -->
      <section class="tab-panel active" data-panel="dashboard">
        <div class="panel-head">
          <h2>Dashboard</h2>
        </div>
        <div class="stats-row">
          <div class="stat-card">
            <span class="stat-label">Total Subscribers</span>
            <strong class="stat-value" id="stat-total-subscribers">–</strong>
          </div>
          <div class="stat-card">
            <span class="stat-label">Active Subscribers</span>
            <strong class="stat-value" id="stat-active-subscribers">–</strong>
          </div>
          <div class="stat-card">
            <span class="stat-label">Unsubscribed</span>
            <strong class="stat-value" id="stat-unsubscribed">–</strong>
          </div>
          <div class="stat-card">
            <span class="stat-label">Clicks (24h)</span>
            <strong class="stat-value" id="stat-clicks-24h">–</strong>
          </div>
          <div class="stat-card">
            <span class="stat-label">Events (24h)</span>
            <strong class="stat-value" id="stat-events-24h">–</strong>
          </div>
        </div>
      </section>

      <!-- Newsletter Manager -->
      <section class="tab-panel" data-panel="newsletter">
        <div class="panel-head">
          <h2>Newsletter Subscribers</h2>
          <div class="head-actions">
            <button class="btn mini" id="newsletter-export">Export CSV</button>
          </div>
        </div>
        <div class="filter-bar">
          <input type="search" id="subscriber-search" placeholder="Search by email…" />
          <select id="subscriber-status-filter">
            <option value="all">All</option>
            <option value="active" selected>Active</option>
            <option value="unsubscribed">Unsubscribed</option>
            <option value="bounced">Bounced</option>
          </select>
          <button class="btn mini ghost" id="subscriber-load">Search</button>
        </div>
        <div class="data-table" id="subscriber-table">
          <div class="table-head">
            <span>Email</span>
            <span>Status</span>
            <span>Created</span>
          </div>
          <div class="table-body" id="subscriber-rows">
            <p class="empty">Loading subscribers…</p>
          </div>
        </div>
      </section>

      <!-- Campaign Composer -->
      <section class="tab-panel" data-panel="campaigns">
        <div class="panel-head">
          <h2>Campaign Composer</h2>
        </div>
        <form id="campaign-form" class="card-form">
          <label class="form-field">
            <span>Subject</span>
            <input type="text" name="subject" placeholder="Weekly Drop Alert" required />
          </label>
          <label class="form-field">
            <span>HTML Content</span>
            <textarea name="html" rows="12" placeholder="<h1>Hello!</h1><p>Check out our latest deals...</p>"></textarea>
          </label>
          <div class="form-actions">
            <label class="form-field inline">
              <span>Test Email</span>
              <input type="email" name="testEmail" placeholder="test@example.com" />
            </label>
            <button type="button" class="btn ghost" id="campaign-test">Send Test</button>
            <button type="submit" class="btn primary">Send to All Active</button>
          </div>
        </form>
      </section>

      <!-- Tracking Link Generator -->
      <section class="tab-panel" data-panel="tracking">
        <div class="panel-head">
          <h2>Tracking Link Generator</h2>
        </div>
        <form id="tracking-form" class="card-form">
          <label class="form-field">
            <span>Slug</span>
            <input type="text" name="slug" placeholder="e.g. psn-summer-deal" required />
          </label>
          <div class="form-row">
            <label class="form-field">
              <span>UTM Source</span>
              <input type="text" name="utm_source" placeholder="e.g. tiktok" />
            </label>
            <label class="form-field">
              <span>UTM Medium</span>
              <input type="text" name="utm_medium" placeholder="e.g. social" />
            </label>
          </div>
          <div class="form-row">
            <label class="form-field">
              <span>UTM Campaign</span>
              <input type="text" name="utm_campaign" placeholder="e.g. summer-sale" />
            </label>
            <label class="form-field">
              <span>UTM Content</span>
              <input type="text" name="utm_content" placeholder="e.g. banner-top" />
            </label>
          </div>
          <button type="submit" class="btn primary">Generate Link</button>
        </form>
        <div id="tracking-result" class="result-box" style="display:none;">
          <p><strong>Generated Link:</strong></p>
          <code id="tracking-url"></code>
          <button class="btn mini ghost" id="copy-tracking-url">Copy</button>
        </div>
      </section>

      <!-- Analytics -->
      <section class="tab-panel" data-panel="analytics">
        <div class="panel-head">
          <h2>Analytics</h2>
        </div>
        <div class="card">
          <h3>Top 10 Links by Clicks</h3>
          <div class="data-table">
            <div class="table-head analytics-head">
              <span>Slug</span>
              <span>Clicks</span>
            </div>
            <div class="table-body" id="analytics-rows">
              <p class="empty">Loading analytics…</p>
            </div>
          </div>
        </div>
        <div class="card">
          <h3>Latest Events</h3>
          <div class="data-table">
            <div class="table-head events-head">
              <span>Type</span>
              <span>Slug</span>
              <span>Time</span>
            </div>
            <div class="table-body" id="events-rows">
              <p class="empty">Loading events…</p>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>
  <div id="toast" class="toast"></div>
  <script type="module" src="./assets/admin.js"></script>
</body>
</html>
