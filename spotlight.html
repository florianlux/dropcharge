<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DropCharge Spotlight</title>
  <meta name="robots" content="index, follow" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="DropCharge Spotlight" id="og-title" />
  <meta property="og:description" content="Exclusive deal ‚Äì grab it before it's gone!" id="og-desc" />
  <meta property="og:image" content="" id="og-image" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Space Grotesk',system-ui,sans-serif;background:#050505;color:#f5f5f5;min-height:100vh;overflow-x:hidden}

    /* Loading state */
    .sp-loading{display:flex;align-items:center;justify-content:center;min-height:100vh;font-size:1.1rem;color:#888}
    .sp-error{display:flex;align-items:center;justify-content:center;min-height:100vh;flex-direction:column;gap:1rem;text-align:center;padding:2rem}
    .sp-error h1{font-size:2rem;background:linear-gradient(135deg,#7c3aed,#06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .sp-error a{color:#a78bfa;text-decoration:none;border-bottom:1px solid rgba(167,139,250,.3)}

    /* Hero */
    .sp-hero{position:relative;min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:2rem 1.5rem;overflow:hidden}
    .sp-hero-bg{position:absolute;inset:0;opacity:.35;background-size:cover;background-position:center;transition:transform 0.3s ease}
    .sp-hero-overlay{position:absolute;inset:0;background:radial-gradient(ellipse at center,rgba(5,5,5,.2) 0%,rgba(5,5,5,.85) 70%,#050505 100%)}
    .sp-glow{position:absolute;width:500px;height:500px;border-radius:50%;filter:blur(120px);opacity:.25;pointer-events:none;animation:glowFloat 6s ease-in-out infinite alternate}
    .sp-glow-1{top:-100px;left:-100px;background:#7c3aed}
    .sp-glow-2{bottom:-100px;right:-100px;background:#06b6d4}
    @keyframes glowFloat{0%{transform:translate(0,0)}100%{transform:translate(30px,20px)}}

    .sp-content{position:relative;z-index:2;max-width:640px;width:100%}

    /* Badge */
    .sp-badge{display:inline-block;padding:.4rem 1rem;border-radius:999px;font-size:.8rem;font-weight:700;letter-spacing:.08em;text-transform:uppercase;background:linear-gradient(135deg,#7c3aed,#06b6d4);color:#fff;margin-bottom:1.5rem;animation:badgePulse 2s ease-in-out infinite;box-shadow:0 0 20px rgba(124,58,237,.4)}
    @keyframes badgePulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}

    /* Logo */
    .sp-logo{max-height:60px;max-width:200px;object-fit:contain;margin-bottom:1.5rem;filter:drop-shadow(0 0 12px rgba(255,255,255,.2))}

    /* Title */
    .sp-title{font-size:clamp(2rem,6vw,3.5rem);font-weight:800;line-height:1.1;margin-bottom:.75rem;background:linear-gradient(135deg,#fff 30%,#a78bfa);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .sp-subtitle{font-size:clamp(1rem,2.5vw,1.25rem);color:rgba(255,255,255,.7);line-height:1.4;margin-bottom:2rem}

    /* Coupon */
    .sp-coupon{display:inline-flex;align-items:center;gap:.75rem;padding:.65rem 1.2rem;border-radius:10px;border:1px dashed rgba(167,139,250,.4);background:rgba(124,58,237,.08);margin-bottom:1.5rem;font-size:.95rem}
    .sp-coupon code{font-weight:700;color:#a78bfa;font-size:1.05rem;letter-spacing:.06em}
    .sp-coupon-copy{background:none;border:none;color:#06b6d4;cursor:pointer;font-size:.85rem;font-weight:600;padding:.2rem .5rem;border-radius:4px;transition:background .15s}
    .sp-coupon-copy:hover{background:rgba(6,182,212,.1)}

    /* CTA */
    .sp-cta{display:inline-flex;align-items:center;gap:.5rem;padding:.9rem 2.2rem;border-radius:999px;font-size:1.1rem;font-weight:700;color:#fff;text-decoration:none;background:linear-gradient(135deg,#7c3aed,#06b6d4);border:none;cursor:pointer;transition:transform .2s,box-shadow .2s;box-shadow:0 0 30px rgba(124,58,237,.4),0 0 60px rgba(6,182,212,.2);position:relative;overflow:hidden}
    .sp-cta:hover{transform:translateY(-2px) scale(1.02);box-shadow:0 0 40px rgba(124,58,237,.6),0 0 80px rgba(6,182,212,.3)}
    .sp-cta::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.15),transparent);transform:translateX(-100%);animation:ctaShine 3s ease-in-out infinite}
    @keyframes ctaShine{0%{transform:translateX(-100%)}40%,100%{transform:translateX(100%)}}
    .sp-cta-arrow{font-size:1.2rem;transition:transform .2s}
    .sp-cta:hover .sp-cta-arrow{transform:translateX(4px)}

    /* Countdown */
    .sp-countdown{margin-top:2rem;display:flex;gap:.75rem;justify-content:center;flex-wrap:wrap}
    .sp-cd-unit{display:flex;flex-direction:column;align-items:center;min-width:64px;padding:.6rem .8rem;border-radius:10px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08)}
    .sp-cd-val{font-size:1.6rem;font-weight:700;font-variant-numeric:tabular-nums;background:linear-gradient(135deg,#a78bfa,#06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .sp-cd-label{font-size:.65rem;text-transform:uppercase;letter-spacing:.1em;color:rgba(255,255,255,.4);margin-top:.15rem}

    /* Expired overlay */
    .sp-expired-overlay{position:fixed;inset:0;z-index:100;background:rgba(5,5,5,.92);display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:2rem;backdrop-filter:blur(8px)}
    .sp-expired-overlay h2{font-size:2rem;margin-bottom:.5rem;color:#a78bfa}
    .sp-expired-overlay p{color:rgba(255,255,255,.6);margin-bottom:1.5rem}
    .sp-expired-overlay a{color:#06b6d4;text-decoration:none;border-bottom:1px solid rgba(6,182,212,.3)}

    /* Brand */
    .sp-brand{font-size:.8rem;color:rgba(255,255,255,.3);margin-top:2.5rem;letter-spacing:.05em}
    .sp-brand a{color:rgba(255,255,255,.4);text-decoration:none}

    /* Hero image */
    .sp-hero-img{max-width:320px;width:100%;border-radius:16px;margin-bottom:2rem;box-shadow:0 8px 40px rgba(0,0,0,.5);border:1px solid rgba(255,255,255,.06)}

    /* Product price card */
    .sp-price-card{display:inline-flex;align-items:baseline;gap:.4rem;padding:.5rem 1.2rem;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);margin-bottom:1.5rem;font-size:1rem}
    .sp-price-amount{font-size:1.6rem;font-weight:800;background:linear-gradient(135deg,#a78bfa,#06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .sp-price-currency{font-size:.9rem;color:rgba(255,255,255,.5)}
    .sp-product-desc{font-size:.9rem;color:rgba(255,255,255,.5);line-height:1.5;margin-bottom:1.5rem;max-width:500px;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}

    /* Theme accents */
    .sp-theme-temu .sp-badge{background:linear-gradient(135deg,#f97316,#a855f7)}
    .sp-theme-temu .sp-cta{background:linear-gradient(135deg,#f97316,#a855f7);box-shadow:0 0 30px rgba(249,115,22,.4),0 0 60px rgba(168,85,247,.2)}
    .sp-theme-temu .sp-glow-1{background:#f97316}
    .sp-theme-temu .sp-glow-2{background:#a855f7}
    .sp-theme-temu .sp-price-amount{background:linear-gradient(135deg,#f97316,#a855f7);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

    .sp-theme-amazon .sp-badge{background:linear-gradient(135deg,#f59e0b,#06b6d4)}
    .sp-theme-amazon .sp-cta{background:linear-gradient(135deg,#f59e0b,#06b6d4);box-shadow:0 0 30px rgba(245,158,11,.4),0 0 60px rgba(6,182,212,.2)}
    .sp-theme-amazon .sp-glow-1{background:#f59e0b}
    .sp-theme-amazon .sp-glow-2{background:#06b6d4}
    .sp-theme-amazon .sp-price-amount{background:linear-gradient(135deg,#f59e0b,#06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

    .sp-theme-g2a .sp-badge{background:linear-gradient(135deg,#3b82f6,#a855f7)}
    .sp-theme-g2a .sp-cta{background:linear-gradient(135deg,#3b82f6,#a855f7);box-shadow:0 0 30px rgba(59,130,246,.4),0 0 60px rgba(168,85,247,.2)}
    .sp-theme-g2a .sp-glow-1{background:#3b82f6}
    .sp-theme-g2a .sp-glow-2{background:#a855f7}
    .sp-theme-g2a .sp-price-amount{background:linear-gradient(135deg,#3b82f6,#a855f7);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

    /* ‚îÄ‚îÄ G2A Enhanced Layout ‚îÄ‚îÄ */
    .sp-g2a-wrap{position:relative;z-index:2;max-width:1100px;width:100%;margin:0 auto;padding:2rem 1.5rem}
    .sp-g2a-chips{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:1rem}
    .sp-g2a-chip{display:inline-block;padding:.25rem .7rem;border-radius:999px;font-size:.72rem;font-weight:700;letter-spacing:.04em;text-transform:uppercase;color:#fff}
    .sp-g2a-chip--steam{background:#1b2838}
    .sp-g2a-chip--ps5,.sp-g2a-chip--ps4{background:#006fcd}
    .sp-g2a-chip--xbox-series,.sp-g2a-chip--xbox-one{background:#107c10}
    .sp-g2a-chip--nintendo-switch{background:#e4000f}
    .sp-g2a-chip--pc{background:#7c3aed}
    .sp-g2a-chip--region{background:rgba(255,255,255,.12);color:rgba(255,255,255,.8);border:1px solid rgba(255,255,255,.15)}

    .sp-g2a-mobile-cta .sp-price-card{margin-bottom:1rem}
    .sp-g2a-mobile-cta .sp-coupon{margin-bottom:1rem}

    .sp-g2a-social{display:flex;align-items:center;gap:1rem;flex-wrap:wrap;font-size:.85rem;color:rgba(255,255,255,.6);margin-bottom:1.5rem}
    .sp-g2a-stars{color:#facc15;font-size:1rem;letter-spacing:1px}
    .sp-g2a-hot{color:#f97316;font-weight:600}

    /* Desktop: two-column layout */
    @media(min-width:1024px){
      .sp-g2a-wrap{display:grid;grid-template-columns:1fr 360px;gap:2.5rem;align-items:start}
      .sp-g2a-left{display:flex;flex-direction:column}
      .sp-g2a-left .sp-hero-img{max-width:100%;margin-bottom:1.5rem}
      .sp-g2a-left .sp-g2a-mobile-cta{display:none}
      .sp-g2a-buybox{position:sticky;top:120px;background:rgba(18,18,24,.95);border:1px solid rgba(59,130,246,.25);border-radius:16px;padding:1.5rem;box-shadow:0 0 40px rgba(59,130,246,.08);display:flex;flex-direction:column;gap:1rem}
      .sp-g2a-buybox .sp-price-card{margin-bottom:0}
      .sp-g2a-buybox .sp-cta{width:100%;justify-content:center;border-radius:12px;padding:1rem;font-size:1.1rem}
      .sp-g2a-trust{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:.4rem;font-size:.82rem;color:rgba(255,255,255,.6)}
      .sp-g2a-trust li::before{content:'‚úì ';color:#22c55e;font-weight:700}
      .sp-g2a-buybox .sp-coupon{margin-bottom:0;width:100%;justify-content:center}
      .sp-g2a-buybox .sp-badge{font-size:.7rem;padding:.3rem .8rem;margin-bottom:0}
    }
    @media(max-width:1023px){
      .sp-g2a-buybox{display:none}
      .sp-g2a-left{display:flex;flex-direction:column;align-items:center;text-align:center}
    }

    /* Mobile sticky bar */
    .sp-g2a-mobilebar{display:none}
    @media(max-width:1023px){
      .sp-g2a-mobilebar{display:flex;position:fixed;bottom:0;left:0;right:0;z-index:50;background:rgba(12,12,18,.96);border-top:1px solid rgba(59,130,246,.2);padding:.75rem 1rem;align-items:center;justify-content:space-between;gap:.75rem;box-shadow:0 -4px 20px rgba(0,0,0,.4);transform:translateY(100%);transition:transform .35s ease}
      .sp-g2a-mobilebar.visible{transform:translateY(0)}
      .sp-g2a-mobilebar-price{font-size:1.1rem;font-weight:800;color:#fff}
      .sp-g2a-mobilebar-cta{padding:.65rem 1.4rem;border-radius:10px;font-size:.95rem;font-weight:700;color:#fff;text-decoration:none;background:linear-gradient(135deg,#3b82f6,#a855f7);border:none;cursor:pointer;white-space:nowrap}
    }

    @media(max-width:480px){
      .sp-countdown{gap:.4rem}
      .sp-cd-unit{min-width:52px;padding:.5rem .6rem}
      .sp-cd-val{font-size:1.3rem}
    }

    /* ‚îÄ‚îÄ G2A Gaming Key-Store Layout ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    .g2a-layout{background:#0b0f1a;min-height:100vh;font-family:'Space Grotesk',system-ui,sans-serif;color:#e2e8f0}

    /* Top nav bar */
    .g2a-nav{display:flex;align-items:center;justify-content:space-between;padding:.65rem 1.2rem;background:rgba(0,0,0,.6);border-bottom:1px solid rgba(59,130,246,.12)}
    .g2a-nav-brand{font-weight:700;font-size:1rem;color:#fff;letter-spacing:.02em}
    .g2a-nav-brand span{color:#3b82f6}
    .g2a-nav-chips{display:flex;gap:.6rem;align-items:center}
    .g2a-trust-chip{font-size:.7rem;color:rgba(255,255,255,.55);display:flex;align-items:center;gap:.25rem}
    .g2a-trust-chip svg{width:14px;height:14px;fill:none;stroke:#3b82f6;stroke-width:2}

    /* Hero / product section */
    .g2a-hero{position:relative;overflow:hidden}
    .g2a-hero-bg{position:absolute;inset:0;background-size:cover;background-position:center;filter:blur(30px) brightness(.35);transform:scale(1.15)}
    .g2a-hero-inner{position:relative;z-index:2;padding:1.5rem 1.2rem;display:flex;flex-direction:column;align-items:center}
    .g2a-product-img{width:100%;max-width:420px;aspect-ratio:16/9;object-fit:cover;border-radius:12px;border:1px solid rgba(59,130,246,.15);box-shadow:0 4px 30px rgba(0,0,0,.5)}
    .g2a-product-title{font-size:clamp(1.4rem,4.5vw,2rem);font-weight:800;margin-top:1.2rem;text-align:center;line-height:1.2}
    .g2a-chips{display:flex;flex-wrap:wrap;gap:.4rem;justify-content:center;margin-top:.75rem}
    .g2a-chip{font-size:.7rem;padding:.25rem .65rem;border-radius:6px;background:rgba(59,130,246,.12);border:1px solid rgba(59,130,246,.2);color:#93c5fd;font-weight:600;text-transform:uppercase;letter-spacing:.04em}
    .g2a-chip--accent{background:rgba(168,85,247,.12);border-color:rgba(168,85,247,.2);color:#c4b5fd}
    .g2a-product-desc{font-size:.85rem;color:rgba(255,255,255,.5);text-align:center;margin-top:.75rem;line-height:1.5;max-width:500px}

    /* Price / deal card */
    .g2a-deal-card{margin:1.2rem 1.2rem 0;padding:1.2rem;border-radius:16px;background:rgba(255,255,255,.04);border:1px solid rgba(59,130,246,.12);position:relative;overflow:hidden}
    .g2a-deal-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,#3b82f6,#a855f7)}
    .g2a-price-row{display:flex;align-items:center;gap:.75rem;flex-wrap:wrap}
    .g2a-price-big{font-size:2rem;font-weight:800;color:#fff}
    .g2a-price-curr{font-size:.9rem;color:rgba(255,255,255,.45);margin-left:.15rem}
    .g2a-price-label{font-size:.75rem;color:rgba(255,255,255,.4)}
    .g2a-price-check{font-size:.95rem;font-weight:600;color:#93c5fd}
    .g2a-discount-pill{display:inline-block;padding:.2rem .6rem;border-radius:6px;font-size:.75rem;font-weight:700;background:linear-gradient(135deg,#3b82f6,#a855f7);color:#fff;margin-left:.5rem}
    .g2a-stock-line{margin-top:.6rem;font-size:.8rem;color:rgba(255,255,255,.45);display:flex;align-items:center;gap:.35rem}
    .g2a-stock-dot{width:6px;height:6px;border-radius:50%;background:#22c55e;display:inline-block}

    /* Coupon */
    .g2a-coupon{display:flex;align-items:center;gap:.6rem;margin-top:.75rem;padding:.5rem .8rem;border-radius:8px;border:1px dashed rgba(59,130,246,.3);background:rgba(59,130,246,.06);font-size:.85rem}
    .g2a-coupon code{font-weight:700;color:#93c5fd;letter-spacing:.04em}
    .g2a-coupon-btn{background:none;border:none;color:#3b82f6;cursor:pointer;font-size:.78rem;font-weight:600;padding:.15rem .4rem;border-radius:4px;transition:background .15s}
    .g2a-coupon-btn:hover{background:rgba(59,130,246,.12)}

    /* Trust section */
    .g2a-trust{display:grid;grid-template-columns:repeat(2,1fr);gap:.6rem;padding:1.2rem;margin:0}
    .g2a-trust-item{display:flex;align-items:center;gap:.5rem;padding:.7rem;border-radius:10px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06)}
    .g2a-trust-icon{width:28px;height:28px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
    .g2a-trust-icon svg{width:20px;height:20px;fill:none;stroke:#3b82f6;stroke-width:1.8}
    .g2a-trust-label{font-size:.78rem;font-weight:600;color:rgba(255,255,255,.7)}

    /* How to redeem */
    .g2a-steps{padding:1.2rem;margin:0}
    .g2a-steps-title{font-size:.9rem;font-weight:700;color:rgba(255,255,255,.6);text-transform:uppercase;letter-spacing:.06em;margin-bottom:.75rem}
    .g2a-step{display:flex;align-items:flex-start;gap:.75rem;margin-bottom:.6rem}
    .g2a-step-num{width:26px;height:26px;border-radius:50%;background:linear-gradient(135deg,#3b82f6,#a855f7);color:#fff;font-size:.75rem;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0}
    .g2a-step-text{font-size:.85rem;color:rgba(255,255,255,.6);line-height:1.4;padding-top:.2rem}

    /* Reviews / social proof */
    .g2a-reviews{margin:0 1.2rem;padding:1rem;border-radius:12px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);text-align:center}
    .g2a-stars{color:#facc15;font-size:1rem;letter-spacing:.1rem}
    .g2a-rating-text{font-size:.8rem;color:rgba(255,255,255,.45);margin-top:.25rem}
    .g2a-ticker{margin-top:.5rem;font-size:.75rem;color:rgba(255,255,255,.35);overflow:hidden;white-space:nowrap}
    .g2a-ticker span{display:inline-block;animation:g2aTick 12s linear infinite}
    @keyframes g2aTick{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}

    /* Sticky bottom bar */
    .g2a-sticky{position:fixed;bottom:0;left:0;right:0;z-index:50;display:flex;align-items:center;justify-content:space-between;padding:.7rem 1.2rem;background:rgba(11,15,26,.95);border-top:1px solid rgba(59,130,246,.15);backdrop-filter:blur(12px)}
    .g2a-sticky-price{font-size:1.1rem;font-weight:700;color:#fff}
    .g2a-sticky-price .g2a-price-check{font-size:.85rem}
    .g2a-sticky-cta{padding:.65rem 1.5rem;border-radius:10px;font-size:.95rem;font-weight:700;color:#fff;background:linear-gradient(135deg,#3b82f6,#a855f7);border:none;cursor:pointer;text-decoration:none;transition:transform .15s,box-shadow .15s;box-shadow:0 0 20px rgba(59,130,246,.3)}
    .g2a-sticky-cta:hover{transform:translateY(-1px);box-shadow:0 0 30px rgba(59,130,246,.5)}
    .g2a-sticky-cta:active{transform:scale(.97)}

    /* Brand footer (G2A) */
    .g2a-footer{text-align:center;padding:1.5rem 1.2rem 5rem;font-size:.75rem;color:rgba(255,255,255,.2)}
    .g2a-footer a{color:rgba(255,255,255,.3);text-decoration:none}

    /* Countdown (G2A variant) */
    .g2a-countdown{display:flex;gap:.5rem;justify-content:center;margin-top:1rem}

    @media(min-width:640px){
      .g2a-hero-inner{padding:2rem}
      .g2a-deal-card,.g2a-trust,.g2a-steps{max-width:560px;margin-left:auto;margin-right:auto}
      .g2a-reviews{max-width:560px;margin-left:auto;margin-right:auto}
      .g2a-trust{grid-template-columns:repeat(4,1fr)}
    }
  </style>
</head>
<body>
  <div id="sp-root">
    <div class="sp-loading" id="sp-loading">Loading spotlight‚Ä¶</div>
  </div>

  <script>
    (function() {
      const API_BASE = window.location.origin;
      const root = document.getElementById('sp-root');

      // Extract slug from /spotlight/{slug}
      const pathParts = window.location.pathname.replace(/\/$/, '').split('/');
      const slug = pathParts[pathParts.length - 1];

      if (!slug || slug === 'spotlight') {
        showError('No spotlight specified.', 'Please check the URL.');
        return;
      }

      fetchSpotlight(slug);

      async function fetchSpotlight(s) {
        try {
          const res = await fetch(API_BASE + '/.netlify/functions/spotlight-get?slug=' + encodeURIComponent(s));
          const data = await res.json();

          if (!res.ok || !data.ok || !data.item) {
            showError('Spotlight not found', 'This deal may have been removed or is no longer available.');
            return;
          }

          renderSpotlight(data.item);
        } catch (err) {
          showError('Connection error', 'Could not load the spotlight. Please try again.');
        }
      }

      /* ‚îÄ‚îÄ Platform & Region auto-detect (G2A) ‚îÄ‚îÄ */
      function detectPlatform(title) {
        var t = (title || '').toLowerCase();
        if (t.indexOf('steam') !== -1) return 'Steam';
        if (t.indexOf('ps5') !== -1 || t.indexOf('playstation 5') !== -1) return 'PS5';
        if (t.indexOf('ps4') !== -1) return 'PS4';
        if (t.indexOf('xbox series') !== -1) return 'Xbox Series';
        if (t.indexOf('xbox one') !== -1) return 'Xbox One';
        if (t.indexOf('switch') !== -1 || t.indexOf('nintendo') !== -1) return 'Nintendo Switch';
        if (t.indexOf('pc') !== -1) return 'PC';
        return 'PC';
      }

      function detectRegion(title) {
        var t = (title || '').toLowerCase();
        if (t.indexOf('global') !== -1) return 'GLOBAL';
        if (t.indexOf(' eu') !== -1 || t.indexOf('(eu)') !== -1 || t.indexOf('/eu') !== -1) return 'EU';
        if (t.indexOf(' us') !== -1 || t.indexOf('(us)') !== -1 || t.indexOf('/us') !== -1) return 'US';
        return 'GLOBAL';
      }

      /* Seeded PRNG for deterministic social proof per slug */
      function seededRandom(seed) {
        var h = 0;
        for (var i = 0; i < seed.length; i++) {
          h = ((h << 5) - h + seed.charCodeAt(i)) | 0;
        }
        return function() {
          h = (h * 16807) % 2147483647;
          if (h < 0) h += 2147483647;
          return (h - 1) / 2147483646;
        };
      }

      function generateSocialProof(seedStr) {
        var rng = seededRandom(seedStr || 'default');
        var rating = (4.4 + rng() * 0.5).toFixed(1);
        var reviews = Math.floor(2000 + rng() * 23000);
        var reviewsStr = reviews >= 1000 ? (reviews / 1000).toFixed(1) + 'k' : String(reviews);
        var purchases = Math.floor(300 + rng() * 1200);

        var stars = '';
        var full = Math.floor(Number(rating));
        for (var i = 0; i < full; i++) stars += '‚òÖ';
        if (Number(rating) - full >= 0.3) stars += '‚òÜ';

        return { rating: rating, reviews: reviewsStr, purchases: purchases, stars: stars };
      }

      /* ‚îÄ‚îÄ G2A-themed layout renderer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
      function renderG2A(item) {
        // OG tags
        var ogTitle = document.getElementById('og-title');
        var ogDesc = document.getElementById('og-desc');
        var ogImg = document.getElementById('og-image');
        if (ogTitle) ogTitle.setAttribute('content', (item.title || 'Deal') + ' ‚Äì DropCharge');
        if (ogDesc) ogDesc.setAttribute('content', item.subtitle || 'Digital key deal on DropCharge');
        if (ogImg && (item.hero_url || item.product_image_url)) ogImg.setAttribute('content', item.hero_url || item.product_image_url);
        document.title = (item.title || 'Deal') + ' ‚Äì DropCharge Spotlight';

        var img = item.hero_url || item.product_image_url || '';
        var title = item.product_title || item.title || 'Deal';
        var desc = item.product_description || 'Limited-time key deal. Prices may change. Click to check availability.';
        var price = item.product_price;
        var currency = item.product_currency || 'EUR';

        var platform = detectPlatform(title);
        var region = detectRegion(title);

        var social = generateSocialProof(item.slug || title);

        // Determine redeem text
        var redeemPlatform = 'Redeem on platform';
        if (platform === 'Steam') redeemPlatform = 'Redeem on Steam';
        else if (platform.indexOf('Xbox') === 0) redeemPlatform = 'Redeem on Xbox';
        else if (platform.indexOf('PS') === 0) redeemPlatform = 'Redeem on PlayStation';
        else if (platform === 'Nintendo Switch') redeemPlatform = 'Redeem on Nintendo eShop';

        var h = '';

        h += '<div class="g2a-layout">';
        h += '<div class="g2a-nav">';
        h += '<div class="g2a-nav-brand"><span>Drop</span>Charge Deals</div>';
        h += '<div class="g2a-nav-chips">';
        h += '<span class="g2a-trust-chip"><svg viewBox="0 0 24 24"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg> Instant Delivery</span>';
        h += '<span class="g2a-trust-chip"><svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg> Secure checkout</span>';
        h += '</div></div>';

        // Hero
        h += '<div class="g2a-hero">';
        if (img) h += '<div class="g2a-hero-bg" id="g2a-hero-bg"></div>';
        h += '<div class="g2a-hero-inner">';
        if (img) h += '<img class="g2a-product-img" src="' + escapeAttr(img) + '" alt="' + escapeAttr(title) + '" />';
        h += '<div class="g2a-product-title">' + escapeHtml(title) + '</div>';
        h += '<div class="g2a-chips">';
        h += '<span class="g2a-chip">' + escapeHtml(platform) + '</span>';
        h += '<span class="g2a-chip">' + escapeHtml(region) + '</span>';
        h += '<span class="g2a-chip g2a-chip--accent">Digital Key</span>';
        h += '</div>';
        h += '<p class="g2a-product-desc">' + escapeHtml(desc) + '</p>';
        h += '</div></div>';

        // Deal card
        h += '<div class="g2a-deal-card">';
        h += '<div class="g2a-price-row">';
        if (price != null) {
          h += '<span class="g2a-price-big">' + escapeHtml(String(price)) + '<span class="g2a-price-curr"> ' + escapeHtml(currency) + '</span></span>';
          h += '<span class="g2a-price-label">Best price today</span>';
        } else {
          h += '<span class="g2a-price-check">Check price</span>';
        }
        if (item.badge_text) h += '<span class="g2a-discount-pill">' + escapeHtml(item.badge_text) + '</span>';
        h += '</div>';
        h += '<div class="g2a-stock-line"><span class="g2a-stock-dot"></span> In stock ‚Ä¢ instant delivery</div>';

        if (item.coupon_code) {
          h += '<div class="g2a-coupon">';
          h += '<span>Use code:</span> <code id="coupon-code">' + escapeHtml(item.coupon_code) + '</code>';
          h += '<button class="g2a-coupon-btn" id="copy-coupon" title="Copy code">Copy</button>';
          h += '</div>';
        }
        h += '</div>';

        // Reviews / social proof
        h += '<div class="g2a-reviews">';
        h += '<div class="g2a-stars">' + escapeHtml(social.stars || '‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ') + '</div>';
        h += '<div class="g2a-rating-text">' + escapeHtml(social.rating) + ' / 5 ‚Äî Community rating (' + escapeHtml(social.reviews) + ')</div>';
        h += '<div class="g2a-ticker"><span>üî• ' + escapeHtml(String(social.purchases)) + ' purchases in the last 24h ‚Ä¢ Instant delivery ‚Ä¢ üî• ' + escapeHtml(String(social.purchases)) + ' purchases in the last 24h</span></div>';
        h += '</div>';

        // Steps
        h += '<div class="g2a-steps">';
        h += '<div class="g2a-steps-title">How to redeem</div>';
        var steps = ['Open deal', 'Purchase key', redeemPlatform];
        for (var si = 0; si < steps.length; si++) {
          h += '<div class="g2a-step"><span class="g2a-step-num">' + (si + 1) + '</span><span class="g2a-step-text">' + escapeHtml(steps[si]) + '</span></div>';
        }
        h += '</div>';

        // Countdown
        if (item.countdown_date) {
          h += '<div class="g2a-countdown sp-countdown" id="sp-countdown">';
          h += cdUnit('--', 'Days') + cdUnit('--', 'Hours') + cdUnit('--', 'Min') + cdUnit('--', 'Sec');
          h += '</div>';
        }

        // Sticky bottom bar
        h += '<div class="g2a-sticky">';
        if (price != null) {
          h += '<span class="g2a-sticky-price">' + escapeHtml(String(price)) + ' <span class="g2a-price-curr">' + escapeHtml(currency) + '</span></span>';
        } else {
          h += '<span class="g2a-sticky-price"><span class="g2a-price-check">Check price</span></span>';
        }
        h += '<a class="g2a-sticky-cta" id="sp-cta-btn" href="' + escapeAttr(item.affiliate_url) + '" target="_blank" rel="noopener noreferrer">' + escapeHtml(item.cta_text || 'Key sichern ‚Üí') + '</a>';
        h += '</div>';

        h += '<p class="g2a-footer">Powered by <a href="/">DropCharge</a></p>';
        h += '</div>';

        root.innerHTML = h;

        bindCTA(item);
        if (item.coupon_code) bindCopyButton();
        if (item.countdown_date) startCountdown(item.countdown_date);
        if (img) {
          var bgEl = document.getElementById('g2a-hero-bg');
          if (bgEl) bgEl.style.backgroundImage = 'url(' + img + ')';
        }
      }
      }

      function renderSpotlight(item) {
        // Theme-based layout switch
        if (item.theme === 'g2a') { renderG2A(item); return; }

        // Update OG tags
        const ogTitle = document.getElementById('og-title');
        const ogDesc = document.getElementById('og-desc');
        const ogImg = document.getElementById('og-image');
        if (ogTitle) ogTitle.setAttribute('content', item.title + ' ‚Äì DropCharge');
        if (ogDesc) ogDesc.setAttribute('content', item.subtitle || 'Exclusive deal on DropCharge');
        if (ogImg && (item.hero_url || item.product_image_url)) ogImg.setAttribute('content', item.hero_url || item.product_image_url);
        document.title = item.title + ' ‚Äì DropCharge Spotlight';

        // Use G2A enhanced layout when theme is g2a
        if (item.theme === 'g2a') {
          renderG2A(item);
          return;
        }

        const gradient = item.gradient || 'linear-gradient(135deg, #7c3aed, #06b6d4)';
        const themeClass = item.theme ? ' sp-theme-' + item.theme : '';
        const heroImage = item.hero_url || item.product_image_url || null;

        let html = '<div class="sp-hero' + themeClass + '">';

        // Background hero image ‚Äî set via DOM to avoid CSS injection
        if (heroImage) {
          html += '<div class="sp-hero-bg" id="sp-parallax"></div>';
        }
        html += '<div class="sp-hero-overlay"></div>';
        html += '<div class="sp-glow sp-glow-1"></div>';
        html += '<div class="sp-glow sp-glow-2"></div>';

        html += '<div class="sp-content">';

        // Badge
        if (item.badge_text) {
          html += '<div class="sp-badge">' + escapeHtml(item.badge_text) + '</div><br>';
        }

        // Logo
        if (item.logo_url) {
          html += '<img class="sp-logo" src="' + escapeAttr(item.logo_url) + '" alt="' + escapeAttr(item.brand || 'Brand') + '" /><br>';
        }

        // Hero image (as content image, not background)
        if (heroImage) {
          html += '<img class="sp-hero-img" src="' + escapeAttr(heroImage) + '" alt="' + escapeAttr(item.title) + '" />';
        }

        // Title + Subtitle
        html += '<h1 class="sp-title">' + escapeHtml(item.title) + '</h1>';
        if (item.subtitle) {
          html += '<p class="sp-subtitle">' + escapeHtml(item.subtitle) + '</p>';
        }

        // Product price card
        if (item.product_price != null) {
          html += '<div class="sp-price-card">';
          html += '<span class="sp-price-amount">' + escapeHtml(String(item.product_price)) + '</span>';
          html += '<span class="sp-price-currency">' + escapeHtml(item.product_currency || 'EUR') + '</span>';
          html += '</div><br>';
        }

        // Product description (if different from subtitle)
        if (item.product_description && item.product_description !== item.subtitle) {
          html += '<p class="sp-product-desc">' + escapeHtml(item.product_description) + '</p>';
        }

        // Coupon
        if (item.coupon_code) {
          html += '<div class="sp-coupon">';
          html += '<span>Code:</span> <code id="coupon-code">' + escapeHtml(item.coupon_code) + '</code>';
          html += '<button class="sp-coupon-copy" id="copy-coupon" title="Copy code">Copy</button>';
          html += '</div><br>';
        }

        // CTA
        html += '<a class="sp-cta" id="sp-cta-btn" href="' + escapeAttr(item.affiliate_url) + '" target="_blank" rel="noopener noreferrer">';
        html += escapeHtml(item.cta_text || 'Jetzt sichern');
        html += ' <span class="sp-cta-arrow">‚Üí</span>';
        html += '</a>';

        // Countdown
        if (item.countdown_date) {
          html += '<div class="sp-countdown" id="sp-countdown">';
          html += cdUnit('--', 'Days') + cdUnit('--', 'Hours') + cdUnit('--', 'Min') + cdUnit('--', 'Sec');
          html += '</div>';
        }

        // Brand footer
        html += '<p class="sp-brand">Powered by <a href="/">DropCharge</a></p>';

        html += '</div></div>';

        root.innerHTML = html;

        // Bind events
        bindCTA(item);
        if (item.coupon_code) bindCopyButton();
        if (item.countdown_date) startCountdown(item.countdown_date);
        if (heroImage) {
          // Set background-image via DOM to prevent CSS injection
          var bgEl = document.getElementById('sp-parallax');
          if (bgEl) bgEl.style.backgroundImage = 'url(' + heroImage + ')';
          initParallax();
        }
      }

      /* ‚îÄ‚îÄ G2A Enhanced Render ‚îÄ‚îÄ */
      function renderG2A(item) {
        var heroImage = item.hero_url || item.product_image_url || null;
        var platform = detectPlatform(item.product_title || item.title);
        var region = detectRegion(item.product_title || item.title);
        var social = generateSocialProof(item.slug);
        var priceStr = item.product_price != null ? escapeHtml(String(item.product_price)) + ' ' + escapeHtml(item.product_currency || 'EUR') : '';

        var html = '<div class="sp-hero sp-theme-g2a">';
        if (heroImage) html += '<div class="sp-hero-bg" id="sp-parallax"></div>';
        html += '<div class="sp-hero-overlay"></div>';
        html += '<div class="sp-glow sp-glow-1"></div>';
        html += '<div class="sp-glow sp-glow-2"></div>';

        html += '<div class="sp-g2a-wrap">';

        /* ‚îÄ‚îÄ Left column ‚îÄ‚îÄ */
        html += '<div class="sp-g2a-left">';
        if (item.logo_url) {
          html += '<img class="sp-logo" src="' + escapeAttr(item.logo_url) + '" alt="' + escapeAttr(item.brand || 'Brand') + '" />';
        }
        if (heroImage) {
          html += '<img class="sp-hero-img" src="' + escapeAttr(heroImage) + '" alt="' + escapeAttr(item.title) + '" />';
        }

        // Platform + Region chips
        html += '<div class="sp-g2a-chips">';
        html += '<span class="sp-g2a-chip ' + platformChipClass(platform) + '">' + escapeHtml(platform) + '</span>';
        html += '<span class="sp-g2a-chip sp-g2a-chip--region">' + escapeHtml(region) + '</span>';
        html += '</div>';

        html += '<h1 class="sp-title">' + escapeHtml(item.title) + '</h1>';
        if (item.subtitle) {
          html += '<p class="sp-subtitle">' + escapeHtml(item.subtitle) + '</p>';
        }

        // Social proof
        html += '<div class="sp-g2a-social">';
        html += '<span class="sp-g2a-stars">' + social.stars + '</span>';
        html += '<span>' + escapeHtml(social.rating) + ' Community rating (' + escapeHtml(social.reviews) + ' reviews)</span>';
        html += '<span class="sp-g2a-hot">\uD83D\uDD25 ' + escapeHtml(String(social.purchases)) + ' purchases in last 24h</span>';
        html += '</div>';

        // Product description
        if (item.product_description && item.product_description !== item.subtitle) {
          html += '<p class="sp-product-desc">' + escapeHtml(item.product_description) + '</p>';
        }

        // Mobile-only price + CTA (shown below 1024px)
        html += '<div class="sp-g2a-mobile-cta">';
        if (item.product_price != null) {
          html += '<div class="sp-price-card">';
          html += '<span class="sp-price-amount">' + escapeHtml(String(item.product_price)) + '</span>';
          html += '<span class="sp-price-currency">' + escapeHtml(item.product_currency || 'EUR') + '</span>';
          html += '</div>';
        }
        if (item.coupon_code) {
          html += '<div class="sp-coupon">';
          html += '<span>Code:</span> <code id="coupon-code">' + escapeHtml(item.coupon_code) + '</code>';
          html += '<button class="sp-coupon-copy" id="copy-coupon" title="Copy code">Copy</button>';
          html += '</div>';
        }
        html += '<a class="sp-cta" id="sp-cta-btn" href="' + escapeAttr(item.affiliate_url) + '" target="_blank" rel="noopener noreferrer">';
        html += escapeHtml(item.cta_text || 'Jetzt sichern');
        html += ' <span class="sp-cta-arrow">\u2192</span>';
        html += '</a>';
        html += '</div>'; // end mobile-cta

        // Countdown
        if (item.countdown_date) {
          html += '<div class="sp-countdown" id="sp-countdown">';
          html += cdUnit('--', 'Days') + cdUnit('--', 'Hours') + cdUnit('--', 'Min') + cdUnit('--', 'Sec');
          html += '</div>';
        }

        html += '<p class="sp-brand">Powered by <a href="/">DropCharge</a></p>';
        html += '</div>'; // end left

        /* ‚îÄ‚îÄ Right column: Desktop sticky buy box ‚îÄ‚îÄ */
        html += '<div class="sp-g2a-buybox">';
        if (item.badge_text) {
          html += '<div class="sp-badge">' + escapeHtml(item.badge_text) + '</div>';
        }
        if (item.product_price != null) {
          html += '<div class="sp-price-card">';
          html += '<span class="sp-price-amount">' + escapeHtml(String(item.product_price)) + '</span>';
          html += '<span class="sp-price-currency">' + escapeHtml(item.product_currency || 'EUR') + '</span>';
          html += '</div>';
        }
        html += '<ul class="sp-g2a-trust"><li>Instant delivery</li><li>Secure checkout</li><li>Buyer protection</li></ul>';
        html += '<a class="sp-cta" id="sp-cta-btn-desktop" href="' + escapeAttr(item.affiliate_url) + '" target="_blank" rel="noopener noreferrer">';
        html += escapeHtml(item.cta_text || 'Jetzt sichern');
        html += ' <span class="sp-cta-arrow">\u2192</span>';
        html += '</a>';
        if (item.coupon_code) {
          html += '<div class="sp-coupon">';
          html += '<span>Code:</span> <code id="coupon-code-desktop">' + escapeHtml(item.coupon_code) + '</code>';
          html += '<button class="sp-coupon-copy" id="copy-coupon-desktop" title="Copy code">Copy</button>';
          html += '</div>';
        }
        html += '</div>'; // end buybox

        html += '</div>'; // end g2a-wrap

        /* ‚îÄ‚îÄ Mobile sticky bar ‚îÄ‚îÄ */
        html += '<div class="sp-g2a-mobilebar" id="sp-mobilebar">';
        html += '<span class="sp-g2a-mobilebar-price">' + (priceStr || 'Check price') + '</span>';
        html += '<a class="sp-g2a-mobilebar-cta" id="sp-cta-btn-mobile" href="' + escapeAttr(item.affiliate_url) + '" target="_blank" rel="noopener noreferrer">' + escapeHtml(item.cta_text || 'Buy now') + '</a>';
        html += '</div>';

        html += '</div>'; // end hero

        root.innerHTML = html;

        // Bind events
        bindCTA(item);
        bindG2ACTA(item);
        if (item.coupon_code) {
          bindCopyButton();
          bindCopyButtonById('copy-coupon-desktop', 'coupon-code-desktop');
        }
        if (item.countdown_date) startCountdown(item.countdown_date);
        if (heroImage) {
          var bgEl = document.getElementById('sp-parallax');
          if (bgEl) bgEl.style.backgroundImage = 'url(' + heroImage + ')';
          initParallax();
        }
        initMobileBar();
      }

      function bindCTA(item) {
        const btn = document.getElementById('sp-cta-btn');
        if (!btn) return;
        btn.addEventListener('click', function(e) {
          // Log the click asynchronously
          try {
            fetch(API_BASE + '/.netlify/functions/spotlight-click', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ slug: item.slug })
            }).catch(function() {});
          } catch (err) { /* fire and forget */ }
        });
      }

      function bindCopyButton() {
        var btn = document.getElementById('copy-coupon');
        var code = document.getElementById('coupon-code');
        if (!btn || !code) return;
        btn.addEventListener('click', function() {
          var text = code.textContent;
          if (navigator.clipboard) {
            navigator.clipboard.writeText(text).then(function() {
              btn.textContent = 'Copied!';
              setTimeout(function() { btn.textContent = 'Copy'; }, 2000);
            });
          }
        });
      }

      function bindG2ACTA(item) {
        ['sp-cta-btn-desktop', 'sp-cta-btn-mobile'].forEach(function(id) {
          var btn = document.getElementById(id);
          if (!btn) return;
          btn.addEventListener('click', function() {
            try {
              fetch(API_BASE + '/.netlify/functions/spotlight-click', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ slug: item.slug })
              }).catch(function() {});
            } catch (err) { /* fire and forget */ }
          });
        });
      }

      function bindCopyButtonById(btnId, codeId) {
        var btn = document.getElementById(btnId);
        var code = document.getElementById(codeId);
        if (!btn || !code) return;
        btn.addEventListener('click', function() {
          var text = code.textContent;
          if (navigator.clipboard) {
            navigator.clipboard.writeText(text).then(function() {
              btn.textContent = 'Copied!';
              setTimeout(function() { btn.textContent = 'Copy'; }, 2000);
            });
          }
        });
      }

      function initMobileBar() {
        var bar = document.getElementById('sp-mobilebar');
        if (!bar) return;
        var shown = false;
        window.addEventListener('scroll', function() {
          var shouldShow = window.scrollY > 200;
          if (shouldShow && !shown) { bar.classList.add('visible'); shown = true; }
          else if (!shouldShow && shown) { bar.classList.remove('visible'); shown = false; }
        }, { passive: true });
      }

      function startCountdown(dateStr) {
        var target = new Date(dateStr).getTime();
        var container = document.getElementById('sp-countdown');
        if (!container) return;

        function update() {
          var now = Date.now();
          var diff = target - now;
          if (diff <= 0) {
            showExpired();
            return;
          }
          var d = Math.floor(diff / 86400000);
          var h = Math.floor((diff % 86400000) / 3600000);
          var m = Math.floor((diff % 3600000) / 60000);
          var s = Math.floor((diff % 60000) / 1000);
          var units = container.querySelectorAll('.sp-cd-val');
          if (units[0]) units[0].textContent = pad(d);
          if (units[1]) units[1].textContent = pad(h);
          if (units[2]) units[2].textContent = pad(m);
          if (units[3]) units[3].textContent = pad(s);
        }
        update();
        setInterval(update, 1000);
      }

      function showExpired() {
        var overlay = document.createElement('div');
        overlay.className = 'sp-expired-overlay';
        overlay.innerHTML = '<h2>Deal Expired</h2><p>This spotlight deal has ended.</p><a href="/">Back to DropCharge</a>';
        document.body.appendChild(overlay);
      }

      function initParallax() {
        var el = document.getElementById('sp-parallax');
        if (!el) return;
        var ticking = false;
        window.addEventListener('mousemove', function(e) {
          if (ticking) return;
          ticking = true;
          requestAnimationFrame(function() {
            var x = (e.clientX / window.innerWidth - 0.5) * 20;
            var y = (e.clientY / window.innerHeight - 0.5) * 20;
            el.style.transform = 'translate(' + x + 'px,' + y + 'px) scale(1.05)';
            ticking = false;
          });
        });
      }

      function showError(title, message) {
        root.innerHTML = '<div class="sp-error"><h1>' + escapeHtml(title) + '</h1><p>' + escapeHtml(message) + '</p><a href="/">‚Üê Back to DropCharge</a></div>';
      }

      function cdUnit(val, label) {
        return '<div class="sp-cd-unit"><span class="sp-cd-val">' + val + '</span><span class="sp-cd-label">' + label + '</span></div>';
      }

      function pad(n) { return n < 10 ? '0' + n : String(n); }

      function escapeHtml(str) {
        var div = document.createElement('div');
        div.textContent = str || '';
        return div.innerHTML;
      }

      function escapeAttr(str) {
        return (str || '').replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
      }
    })();
  </script>
</body>
</html>
